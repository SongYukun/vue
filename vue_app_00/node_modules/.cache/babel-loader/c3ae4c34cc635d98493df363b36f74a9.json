{"remainingRequest":"C:\\Users\\web\\Desktop\\vue_app_00\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\web\\Desktop\\vue_app_00\\src\\lib\\mui\\js\\mui.previewimage.js","dependencies":[{"path":"C:\\Users\\web\\Desktop\\vue_app_00\\src\\lib\\mui\\js\\mui.previewimage.js","mtime":1536566855000},{"path":"C:\\Users\\web\\Desktop\\vue_app_00\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1534853417988},{"path":"C:\\Users\\web\\Desktop\\vue_app_00\\node_modules\\babel-loader\\lib\\index.js","mtime":1529635966000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.replace\";\n\n(function ($, window) {\n  var template = '<div id=\"{{id}}\" class=\"mui-slider mui-preview-image mui-fullscreen\"><div class=\"mui-preview-header\">{{header}}</div><div class=\"mui-slider-group\"></div><div class=\"mui-preview-footer mui-hidden\">{{footer}}</div><div class=\"mui-preview-loading\"><span class=\"mui-spinner mui-spinner-white\"></span></div></div>';\n  var itemTemplate = '<div class=\"mui-slider-item mui-zoom-wrapper {{className}}\"><div class=\"mui-zoom-scroller\"><img src=\"{{src}}\" data-preview-lazyload=\"{{lazyload}}\" style=\"{{style}}\" class=\"mui-zoom\"></div></div>';\n  var defaultGroupName = '__DEFAULT';\n  var div = document.createElement('div');\n  var imgId = 0;\n\n  var PreviewImage = function PreviewImage(options) {\n    this.options = $.extend(true, {\n      id: '__MUI_PREVIEWIMAGE',\n      zoom: true,\n      header: '<span class=\"mui-preview-indicator\"></span>',\n      footer: ''\n    }, options || {});\n    this.init();\n    this.initEvent();\n  };\n\n  var proto = PreviewImage.prototype;\n\n  proto.init = function () {\n    var options = this.options;\n    var el = document.getElementById(this.options.id);\n\n    if (!el) {\n      div.innerHTML = template.replace(/\\{\\{id\\}\\}/g, this.options.id).replace('{{header}}', options.header).replace('{{footer}}', options.footer);\n      document.body.appendChild(div.firstElementChild);\n      el = document.getElementById(this.options.id);\n    }\n\n    this.element = el;\n    this.scroller = this.element.querySelector($.classSelector('.slider-group'));\n    this.indicator = this.element.querySelector($.classSelector('.preview-indicator'));\n    this.loader = this.element.querySelector($.classSelector('.preview-loading'));\n\n    if (options.footer) {\n      this.element.querySelector($.classSelector('.preview-footer')).classList.remove($.className('hidden'));\n    }\n\n    this.addImages();\n  };\n\n  proto.initEvent = function () {\n    var self = this;\n    $(document.body).on('tap', 'img[data-preview-src]', function () {\n      self.open(this);\n      return false;\n    });\n    var laterClose = null;\n\n    var laterCloseEvent = function laterCloseEvent() {\n      !laterClose && (laterClose = $.later(function () {\n        self.loader.removeEventListener('tap', laterCloseEvent);\n        self.scroller.removeEventListener('tap', laterCloseEvent);\n        self.close();\n      }, 300));\n    };\n\n    this.scroller.addEventListener('doubletap', function () {\n      if (laterClose) {\n        laterClose.cancel();\n        laterClose = null;\n      }\n    });\n    this.element.addEventListener('webkitAnimationEnd', function () {\n      if (self.element.classList.contains($.className('preview-out'))) {\n        //close\n        self.element.style.display = 'none';\n        self.element.classList.remove($.className('preview-out'));\n        self.element.classList.remove($.className('preview-in'));\n        laterClose = null;\n      } else {\n        //open\n        self.loader.addEventListener('tap', laterCloseEvent);\n        self.scroller.addEventListener('tap', laterCloseEvent);\n      }\n    });\n    this.element.addEventListener('slide', function (e) {\n      if (self.options.zoom) {\n        var lastZoomerEl = self.element.querySelector('.mui-zoom-wrapper:nth-child(' + (self.lastIndex + 1) + ')');\n\n        if (lastZoomerEl) {\n          $(lastZoomerEl).zoom().setZoom(1);\n        }\n      }\n\n      var slideNumber = e.detail.slideNumber;\n      self.lastIndex = slideNumber;\n      self.indicator && (self.indicator.innerText = slideNumber + 1 + '/' + self.currentGroup.length);\n\n      self._loadItem(slideNumber);\n    });\n  };\n\n  proto.addImages = function (group, index) {\n    this.groups = {};\n    var imgs = [];\n\n    if (group) {\n      if (group === defaultGroupName) {\n        imgs = document.querySelectorAll(\"img[data-preview-src]:not([data-preview-group])\");\n      } else {\n        imgs = document.querySelectorAll(\"img[data-preview-src][data-preview-group='\" + group + \"']\");\n      }\n    } else {\n      imgs = document.querySelectorAll(\"img[data-preview-src]\");\n    }\n\n    if (imgs.length) {\n      for (var i = 0, len = imgs.length; i < len; i++) {\n        this.addImage(imgs[i]);\n      }\n    }\n  };\n\n  proto.addImage = function (img) {\n    var group = img.getAttribute('data-preview-group');\n    group = group || defaultGroupName;\n\n    if (!this.groups[group]) {\n      this.groups[group] = [];\n    }\n\n    var src = img.getAttribute('src');\n\n    if (img.__mui_img_data && img.__mui_img_data.src === src) {\n      //已缓存且图片未变化\n      this.groups[group].push(img.__mui_img_data);\n    } else {\n      var lazyload = img.getAttribute('data-preview-src');\n\n      if (!lazyload) {\n        lazyload = src;\n      }\n\n      var imgObj = {\n        src: src,\n        lazyload: src === lazyload ? '' : lazyload,\n        loaded: src === lazyload ? true : false,\n        sWidth: 0,\n        sHeight: 0,\n        sTop: 0,\n        sLeft: 0,\n        sScale: 1,\n        el: img\n      };\n      this.groups[group].push(imgObj);\n      img.__mui_img_data = imgObj;\n    }\n  };\n\n  proto.empty = function () {\n    this.scroller.innerHTML = '';\n  };\n\n  proto._initImgData = function (itemData, imgEl) {\n    if (!itemData.sWidth) {\n      var img = itemData.el;\n      itemData.sWidth = img.offsetWidth;\n      itemData.sHeight = img.offsetHeight;\n      var offset = $.offset(img);\n      itemData.sTop = offset.top;\n      itemData.sLeft = offset.left;\n      itemData.sScale = Math.max(itemData.sWidth / window.innerWidth, itemData.sHeight / window.innerHeight);\n    }\n\n    imgEl.style.webkitTransform = 'translate3d(0,0,0) scale(' + itemData.sScale + ')';\n  };\n\n  proto._getScale = function (from, to) {\n    var scaleX = from.width / to.width;\n    var scaleY = from.height / to.height;\n    var scale = 1;\n\n    if (scaleX <= scaleY) {\n      scale = from.height / (to.height * scaleX);\n    } else {\n      scale = from.width / (to.width * scaleY);\n    }\n\n    return scale;\n  };\n\n  proto._imgTransitionEnd = function (e) {\n    var img = e.target;\n    img.classList.remove($.className('transitioning'));\n    img.removeEventListener('webkitTransitionEnd', this._imgTransitionEnd.bind(this));\n  };\n\n  proto._loadItem = function (index, isOpening) {\n    //TODO 暂时仅支持img\n    var itemEl = this.scroller.querySelector($.classSelector('.slider-item:nth-child(' + (index + 1) + ')'));\n    var itemData = this.currentGroup[index];\n    var imgEl = itemEl.querySelector('img');\n\n    this._initImgData(itemData, imgEl);\n\n    if (isOpening) {\n      var posi = this._getPosition(itemData);\n\n      imgEl.style.webkitTransitionDuration = '0ms';\n      imgEl.style.webkitTransform = 'translate3d(' + posi.x + 'px,' + posi.y + 'px,0) scale(' + itemData.sScale + ')';\n      imgEl.offsetHeight;\n    }\n\n    if (!itemData.loaded && imgEl.getAttribute('data-preview-lazyload')) {\n      var self = this;\n      self.loader.classList.add($.className('active')); //移动位置动画\n\n      imgEl.style.webkitTransitionDuration = '0.5s';\n      imgEl.addEventListener('webkitTransitionEnd', self._imgTransitionEnd.bind(self));\n      imgEl.style.webkitTransform = 'translate3d(0,0,0) scale(' + itemData.sScale + ')';\n      this.loadImage(imgEl, function () {\n        itemData.loaded = true;\n        imgEl.src = itemData.lazyload;\n\n        self._initZoom(itemEl, this.width, this.height);\n\n        imgEl.classList.add($.className('transitioning'));\n        imgEl.addEventListener('webkitTransitionEnd', self._imgTransitionEnd.bind(self));\n        imgEl.setAttribute('style', '');\n        imgEl.offsetHeight;\n        self.loader.classList.remove($.className('active'));\n      });\n    } else {\n      itemData.lazyload && (imgEl.src = itemData.lazyload);\n\n      this._initZoom(itemEl, imgEl.width, imgEl.height);\n\n      imgEl.classList.add($.className('transitioning'));\n      imgEl.addEventListener('webkitTransitionEnd', this._imgTransitionEnd.bind(this));\n      imgEl.setAttribute('style', '');\n      imgEl.offsetHeight;\n    }\n\n    this._preloadItem(index + 1);\n\n    this._preloadItem(index - 1);\n  };\n\n  proto._preloadItem = function (index) {\n    var itemEl = this.scroller.querySelector($.classSelector('.slider-item:nth-child(' + (index + 1) + ')'));\n\n    if (itemEl) {\n      var itemData = this.currentGroup[index];\n\n      if (!itemData.sWidth) {\n        var imgEl = itemEl.querySelector('img');\n\n        this._initImgData(itemData, imgEl);\n      }\n    }\n  };\n\n  proto._initZoom = function (zoomWrapperEl, zoomerWidth, zoomerHeight) {\n    if (!this.options.zoom) {\n      return;\n    }\n\n    if (zoomWrapperEl.getAttribute('data-zoomer')) {\n      return;\n    }\n\n    var zoomEl = zoomWrapperEl.querySelector($.classSelector('.zoom'));\n\n    if (zoomEl.tagName === 'IMG') {\n      var self = this;\n\n      var maxZoom = self._getScale({\n        width: zoomWrapperEl.offsetWidth,\n        height: zoomWrapperEl.offsetHeight\n      }, {\n        width: zoomerWidth,\n        height: zoomerHeight\n      });\n\n      $(zoomWrapperEl).zoom({\n        maxZoom: Math.max(maxZoom, 1)\n      });\n    } else {\n      $(zoomWrapperEl).zoom();\n    }\n  };\n\n  proto.loadImage = function (imgEl, callback) {\n    var onReady = function onReady() {\n      callback && callback.call(this);\n    };\n\n    var img = new Image();\n    img.onload = onReady;\n    img.onerror = onReady;\n    img.src = imgEl.getAttribute('data-preview-lazyload');\n  };\n\n  proto.getRangeByIndex = function (index, length) {\n    return {\n      from: 0,\n      to: length - 1\n    }; //\t\tvar from = Math.max(index - 1, 0);\n    //\t\tvar to = Math.min(index + 1, length);\n    //\t\tif (index === length - 1) {\n    //\t\t\tfrom = Math.max(length - 3, 0);\n    //\t\t\tto = length - 1;\n    //\t\t}\n    //\t\tif (index === 0) {\n    //\t\t\tfrom = 0;\n    //\t\t\tto = Math.min(2, length - 1);\n    //\t\t}\n    //\t\treturn {\n    //\t\t\tfrom: from,\n    //\t\t\tto: to\n    //\t\t};\n  };\n\n  proto._getPosition = function (itemData) {\n    var sLeft = itemData.sLeft - window.pageXOffset;\n    var sTop = itemData.sTop - window.pageYOffset;\n    var left = (window.innerWidth - itemData.sWidth) / 2;\n    var top = (window.innerHeight - itemData.sHeight) / 2;\n    return {\n      left: sLeft,\n      top: sTop,\n      x: sLeft - left,\n      y: sTop - top\n    };\n  };\n\n  proto.refresh = function (index, groupArray) {\n    this.currentGroup = groupArray; //重新生成slider\n\n    var length = groupArray.length;\n    var itemHtml = [];\n    var currentRange = this.getRangeByIndex(index, length);\n    var from = currentRange.from;\n    var to = currentRange.to + 1;\n    var currentIndex = index;\n    var className = '';\n    var itemStr = '';\n    var wWidth = window.innerWidth;\n    var wHeight = window.innerHeight;\n\n    for (var i = 0; from < to; from++, i++) {\n      var itemData = groupArray[from];\n      var style = '';\n\n      if (itemData.sWidth) {\n        style = '-webkit-transform:translate3d(0,0,0) scale(' + itemData.sScale + ');transform:translate3d(0,0,0) scale(' + itemData.sScale + ')';\n      }\n\n      itemStr = itemTemplate.replace('{{src}}', itemData.src).replace('{{lazyload}}', itemData.lazyload).replace('{{style}}', style);\n\n      if (from === index) {\n        currentIndex = i;\n        className = $.className('active');\n      } else {\n        className = '';\n      }\n\n      itemHtml.push(itemStr.replace('{{className}}', className));\n    }\n\n    this.scroller.innerHTML = itemHtml.join('');\n    this.element.style.display = 'block';\n    this.element.classList.add($.className('preview-in'));\n    this.lastIndex = currentIndex;\n    this.element.offsetHeight;\n    $(this.element).slider().gotoItem(currentIndex, 0);\n    this.indicator && (this.indicator.innerText = currentIndex + 1 + '/' + this.currentGroup.length);\n\n    this._loadItem(currentIndex, true);\n  };\n\n  proto.openByGroup = function (index, group) {\n    index = Math.min(Math.max(0, index), this.groups[group].length - 1);\n    this.refresh(index, this.groups[group]);\n  };\n\n  proto.open = function (index, group) {\n    if (this.isShown()) {\n      return;\n    }\n\n    if (typeof index === \"number\") {\n      group = group || defaultGroupName;\n      this.addImages(group, index); //刷新当前group\n\n      this.openByGroup(index, group);\n    } else {\n      group = index.getAttribute('data-preview-group');\n      group = group || defaultGroupName;\n      this.addImages(group, index); //刷新当前group\n\n      this.openByGroup(this.groups[group].indexOf(index.__mui_img_data), group);\n    }\n  };\n\n  proto.close = function (index, group) {\n    if (!this.isShown()) {\n      return;\n    }\n\n    this.element.classList.remove($.className('preview-in'));\n    this.element.classList.add($.className('preview-out'));\n    var itemEl = this.scroller.querySelector($.classSelector('.slider-item:nth-child(' + (this.lastIndex + 1) + ')'));\n    var imgEl = itemEl.querySelector('img');\n\n    if (imgEl) {\n      imgEl.classList.add($.className('transitioning'));\n      var itemData = this.currentGroup[this.lastIndex];\n\n      var posi = this._getPosition(itemData);\n\n      var sLeft = posi.left;\n      var sTop = posi.top;\n\n      if (sTop > window.innerHeight || sLeft > window.innerWidth || sTop < 0 || sLeft < 0) {\n        //out viewport\n        imgEl.style.opacity = 0;\n        imgEl.style.webkitTransitionDuration = '0.5s';\n        imgEl.style.webkitTransform = 'scale(' + itemData.sScale + ')';\n      } else {\n        if (this.options.zoom) {\n          $(imgEl.parentNode.parentNode).zoom().toggleZoom(0);\n        }\n\n        imgEl.style.webkitTransitionDuration = '0.5s';\n        imgEl.style.webkitTransform = 'translate3d(' + posi.x + 'px,' + posi.y + 'px,0) scale(' + itemData.sScale + ')';\n      }\n    }\n\n    var zoomers = this.element.querySelectorAll($.classSelector('.zoom-wrapper'));\n\n    for (var i = 0, len = zoomers.length; i < len; i++) {\n      $(zoomers[i]).zoom().destroy();\n    }\n\n    $(this.element).slider().destroy(); //\t\tthis.empty();\n  };\n\n  proto.isShown = function () {\n    return this.element.classList.contains($.className('preview-in'));\n  };\n\n  var previewImageApi = null;\n\n  $.previewImage = function (options) {\n    if (!previewImageApi) {\n      previewImageApi = new PreviewImage(options);\n    }\n\n    return previewImageApi;\n  };\n\n  $.getPreviewImage = function () {\n    return previewImageApi;\n  };\n})(mui, window);",{"version":3,"sources":["src\\lib\\mui\\js\\mui.previewimage.js"],"names":["$","window","template","itemTemplate","defaultGroupName","div","document","createElement","imgId","PreviewImage","options","extend","id","zoom","header","footer","init","initEvent","proto","prototype","el","getElementById","innerHTML","replace","body","appendChild","firstElementChild","element","scroller","querySelector","classSelector","indicator","loader","classList","remove","className","addImages","self","on","open","laterClose","laterCloseEvent","later","removeEventListener","close","addEventListener","cancel","contains","style","display","e","lastZoomerEl","lastIndex","setZoom","slideNumber","detail","innerText","currentGroup","length","_loadItem","group","index","groups","imgs","querySelectorAll","i","len","addImage","img","getAttribute","src","__mui_img_data","push","lazyload","imgObj","loaded","sWidth","sHeight","sTop","sLeft","sScale","empty","_initImgData","itemData","imgEl","offsetWidth","offsetHeight","offset","top","left","Math","max","innerWidth","innerHeight","webkitTransform","_getScale","from","to","scaleX","width","scaleY","height","scale","_imgTransitionEnd","target","bind","isOpening","itemEl","posi","_getPosition","webkitTransitionDuration","x","y","add","loadImage","_initZoom","setAttribute","_preloadItem","zoomWrapperEl","zoomerWidth","zoomerHeight","zoomEl","tagName","maxZoom","callback","onReady","call","Image","onload","onerror","getRangeByIndex","pageXOffset","pageYOffset","refresh","groupArray","itemHtml","currentRange","currentIndex","itemStr","wWidth","wHeight","join","slider","gotoItem","openByGroup","min","isShown","indexOf","opacity","parentNode","toggleZoom","zoomers","destroy","previewImageApi","previewImage","getPreviewImage","mui"],"mappings":"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","sourceRoot":"C:\\Users\\web\\Desktop\\vue_app_00","sourcesContent":["(function($, window) {\n\n\tvar template = '<div id=\"{{id}}\" class=\"mui-slider mui-preview-image mui-fullscreen\"><div class=\"mui-preview-header\">{{header}}</div><div class=\"mui-slider-group\"></div><div class=\"mui-preview-footer mui-hidden\">{{footer}}</div><div class=\"mui-preview-loading\"><span class=\"mui-spinner mui-spinner-white\"></span></div></div>';\n\tvar itemTemplate = '<div class=\"mui-slider-item mui-zoom-wrapper {{className}}\"><div class=\"mui-zoom-scroller\"><img src=\"{{src}}\" data-preview-lazyload=\"{{lazyload}}\" style=\"{{style}}\" class=\"mui-zoom\"></div></div>';\n\tvar defaultGroupName = '__DEFAULT';\n\tvar div = document.createElement('div');\n\tvar imgId = 0;\n\tvar PreviewImage = function(options) {\n\t\tthis.options = $.extend(true, {\n\t\t\tid: '__MUI_PREVIEWIMAGE',\n\t\t\tzoom: true,\n\t\t\theader: '<span class=\"mui-preview-indicator\"></span>',\n\t\t\tfooter: ''\n\t\t}, options || {});\n\t\tthis.init();\n\t\tthis.initEvent();\n\t};\n\tvar proto = PreviewImage.prototype;\n\tproto.init = function() {\n\t\tvar options = this.options;\n\t\tvar el = document.getElementById(this.options.id);\n\t\tif (!el) {\n\t\t\tdiv.innerHTML = template.replace(/\\{\\{id\\}\\}/g, this.options.id).replace('{{header}}', options.header).replace('{{footer}}', options.footer);\n\t\t\tdocument.body.appendChild(div.firstElementChild);\n\t\t\tel = document.getElementById(this.options.id);\n\t\t}\n\n\t\tthis.element = el;\n\t\tthis.scroller = this.element.querySelector($.classSelector('.slider-group'));\n\t\tthis.indicator = this.element.querySelector($.classSelector('.preview-indicator'));\n\t\tthis.loader = this.element.querySelector($.classSelector('.preview-loading'));\n\t\tif (options.footer) {\n\t\t\tthis.element.querySelector($.classSelector('.preview-footer')).classList.remove($.className('hidden'));\n\t\t}\n\t\tthis.addImages();\n\t};\n\tproto.initEvent = function() {\n\t\tvar self = this;\n\t\t$(document.body).on('tap', 'img[data-preview-src]', function() {\n\t\t\tself.open(this);\n\t\t\treturn false;\n\t\t});\n\t\tvar laterClose = null;\n\t\tvar laterCloseEvent = function() {\n\t\t\t!laterClose && (laterClose = $.later(function() {\n\t\t\t\tself.loader.removeEventListener('tap', laterCloseEvent);\n\t\t\t\tself.scroller.removeEventListener('tap', laterCloseEvent);\n\t\t\t\tself.close();\n\t\t\t}, 300));\n\t\t};\n\t\tthis.scroller.addEventListener('doubletap', function() {\n\t\t\tif (laterClose) {\n\t\t\t\tlaterClose.cancel();\n\t\t\t\tlaterClose = null;\n\t\t\t}\n\t\t});\n\t\tthis.element.addEventListener('webkitAnimationEnd', function() {\n\t\t\tif (self.element.classList.contains($.className('preview-out'))) { //close\n\t\t\t\tself.element.style.display = 'none';\n\t\t\t\tself.element.classList.remove($.className('preview-out'));\n\t\t\t\tself.element.classList.remove($.className('preview-in'));\n\t\t\t\tlaterClose = null;\n\t\t\t} else { //open\n\t\t\t\tself.loader.addEventListener('tap', laterCloseEvent);\n\t\t\t\tself.scroller.addEventListener('tap', laterCloseEvent);\n\t\t\t}\n\t\t});\n\t\tthis.element.addEventListener('slide', function(e) {\n\t\t\tif (self.options.zoom) {\n\t\t\t\tvar lastZoomerEl = self.element.querySelector('.mui-zoom-wrapper:nth-child(' + (self.lastIndex + 1) + ')');\n\t\t\t\tif (lastZoomerEl) {\n\t\t\t\t\t$(lastZoomerEl).zoom().setZoom(1);\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar slideNumber = e.detail.slideNumber;\n\t\t\tself.lastIndex = slideNumber;\n\t\t\tself.indicator && (self.indicator.innerText = (slideNumber + 1) + '/' + self.currentGroup.length);\n\t\t\tself._loadItem(slideNumber);\n\n\t\t});\n\t};\n\tproto.addImages = function(group, index) {\n\t\tthis.groups = {};\n\t\tvar imgs = [];\n\t\tif (group) {\n\t\t\tif (group === defaultGroupName) {\n\t\t\t\timgs = document.querySelectorAll(\"img[data-preview-src]:not([data-preview-group])\");\n\t\t\t} else {\n\t\t\t\timgs = document.querySelectorAll(\"img[data-preview-src][data-preview-group='\" + group + \"']\");\n\t\t\t}\n\t\t} else {\n\t\t\timgs = document.querySelectorAll(\"img[data-preview-src]\");\n\t\t}\n\t\tif (imgs.length) {\n\t\t\tfor (var i = 0, len = imgs.length; i < len; i++) {\n\t\t\t\tthis.addImage(imgs[i]);\n\t\t\t}\n\t\t}\n\t};\n\tproto.addImage = function(img) {\n\t\tvar group = img.getAttribute('data-preview-group');\n\t\tgroup = group || defaultGroupName;\n\t\tif (!this.groups[group]) {\n\t\t\tthis.groups[group] = [];\n\t\t}\n\t\tvar src = img.getAttribute('src');\n\t\tif (img.__mui_img_data && img.__mui_img_data.src === src) { //已缓存且图片未变化\n\t\t\tthis.groups[group].push(img.__mui_img_data);\n\t\t} else {\n\t\t\tvar lazyload = img.getAttribute('data-preview-src');\n\t\t\tif (!lazyload) {\n\t\t\t\tlazyload = src;\n\t\t\t}\n\t\t\tvar imgObj = {\n\t\t\t\tsrc: src,\n\t\t\t\tlazyload: src === lazyload ? '' : lazyload,\n\t\t\t\tloaded: src === lazyload ? true : false,\n\t\t\t\tsWidth: 0,\n\t\t\t\tsHeight: 0,\n\t\t\t\tsTop: 0,\n\t\t\t\tsLeft: 0,\n\t\t\t\tsScale: 1,\n\t\t\t\tel: img\n\t\t\t};\n\t\t\tthis.groups[group].push(imgObj);\n\t\t\timg.__mui_img_data = imgObj;\n\t\t}\n\t};\n\n\n\tproto.empty = function() {\n\t\tthis.scroller.innerHTML = '';\n\t};\n\tproto._initImgData = function(itemData, imgEl) {\n\t\tif (!itemData.sWidth) {\n\t\t\tvar img = itemData.el;\n\t\t\titemData.sWidth = img.offsetWidth;\n\t\t\titemData.sHeight = img.offsetHeight;\n\t\t\tvar offset = $.offset(img);\n\t\t\titemData.sTop = offset.top;\n\t\t\titemData.sLeft = offset.left;\n\t\t\titemData.sScale = Math.max(itemData.sWidth / window.innerWidth, itemData.sHeight / window.innerHeight);\n\t\t}\n\t\timgEl.style.webkitTransform = 'translate3d(0,0,0) scale(' + itemData.sScale + ')';\n\t};\n\n\tproto._getScale = function(from, to) {\n\t\tvar scaleX = from.width / to.width;\n\t\tvar scaleY = from.height / to.height;\n\t\tvar scale = 1;\n\t\tif (scaleX <= scaleY) {\n\t\t\tscale = from.height / (to.height * scaleX);\n\t\t} else {\n\t\t\tscale = from.width / (to.width * scaleY);\n\t\t}\n\t\treturn scale;\n\t};\n\tproto._imgTransitionEnd = function(e) {\n\t\tvar img = e.target;\n\t\timg.classList.remove($.className('transitioning'));\n\t\timg.removeEventListener('webkitTransitionEnd', this._imgTransitionEnd.bind(this));\n\t};\n\tproto._loadItem = function(index, isOpening) { //TODO 暂时仅支持img\n\t\tvar itemEl = this.scroller.querySelector($.classSelector('.slider-item:nth-child(' + (index + 1) + ')'));\n\t\tvar itemData = this.currentGroup[index];\n\t\tvar imgEl = itemEl.querySelector('img');\n\t\tthis._initImgData(itemData, imgEl);\n\t\tif (isOpening) {\n\t\t\tvar posi = this._getPosition(itemData);\n\t\t\timgEl.style.webkitTransitionDuration = '0ms';\n\t\t\timgEl.style.webkitTransform = 'translate3d(' + posi.x + 'px,' + posi.y + 'px,0) scale(' + itemData.sScale + ')';\n\t\t\timgEl.offsetHeight;\n\t\t}\n\t\tif (!itemData.loaded && imgEl.getAttribute('data-preview-lazyload')) {\n\t\t\tvar self = this;\n\t\t\tself.loader.classList.add($.className('active'));\n\t\t\t//移动位置动画\n\t\t\timgEl.style.webkitTransitionDuration = '0.5s';\n\t\t\timgEl.addEventListener('webkitTransitionEnd', self._imgTransitionEnd.bind(self));\n\t\t\timgEl.style.webkitTransform = 'translate3d(0,0,0) scale(' + itemData.sScale + ')';\n\t\t\tthis.loadImage(imgEl, function() {\n\t\t\t\titemData.loaded = true;\n\t\t\t\timgEl.src = itemData.lazyload;\n\t\t\t\tself._initZoom(itemEl, this.width, this.height);\n\t\t\t\timgEl.classList.add($.className('transitioning'));\n\t\t\t\timgEl.addEventListener('webkitTransitionEnd', self._imgTransitionEnd.bind(self));\n\t\t\t\timgEl.setAttribute('style', '');\n\t\t\t\timgEl.offsetHeight;\n\t\t\t\tself.loader.classList.remove($.className('active'));\n\t\t\t});\n\t\t} else {\n\t\t\titemData.lazyload && (imgEl.src = itemData.lazyload);\n\t\t\tthis._initZoom(itemEl, imgEl.width, imgEl.height);\n\t\t\timgEl.classList.add($.className('transitioning'));\n\t\t\timgEl.addEventListener('webkitTransitionEnd', this._imgTransitionEnd.bind(this));\n\t\t\timgEl.setAttribute('style', '');\n\t\t\timgEl.offsetHeight;\n\t\t}\n\t\tthis._preloadItem(index + 1);\n\t\tthis._preloadItem(index - 1);\n\t};\n\tproto._preloadItem = function(index) {\n\t\tvar itemEl = this.scroller.querySelector($.classSelector('.slider-item:nth-child(' + (index + 1) + ')'));\n\t\tif (itemEl) {\n\t\t\tvar itemData = this.currentGroup[index];\n\t\t\tif (!itemData.sWidth) {\n\t\t\t\tvar imgEl = itemEl.querySelector('img');\n\t\t\t\tthis._initImgData(itemData, imgEl);\n\t\t\t}\n\t\t}\n\t};\n\tproto._initZoom = function(zoomWrapperEl, zoomerWidth, zoomerHeight) {\n\t\tif (!this.options.zoom) {\n\t\t\treturn;\n\t\t}\n\t\tif (zoomWrapperEl.getAttribute('data-zoomer')) {\n\t\t\treturn;\n\t\t}\n\t\tvar zoomEl = zoomWrapperEl.querySelector($.classSelector('.zoom'));\n\t\tif (zoomEl.tagName === 'IMG') {\n\t\t\tvar self = this;\n\t\t\tvar maxZoom = self._getScale({\n\t\t\t\twidth: zoomWrapperEl.offsetWidth,\n\t\t\t\theight: zoomWrapperEl.offsetHeight\n\t\t\t}, {\n\t\t\t\twidth: zoomerWidth,\n\t\t\t\theight: zoomerHeight\n\t\t\t});\n\t\t\t$(zoomWrapperEl).zoom({\n\t\t\t\tmaxZoom: Math.max(maxZoom, 1)\n\t\t\t});\n\t\t} else {\n\t\t\t$(zoomWrapperEl).zoom();\n\t\t}\n\t};\n\tproto.loadImage = function(imgEl, callback) {\n\t\tvar onReady = function() {\n\t\t\tcallback && callback.call(this);\n\t\t};\n\t\tvar img = new Image();\n\t\timg.onload = onReady;\n\t\timg.onerror = onReady;\n\t\timg.src = imgEl.getAttribute('data-preview-lazyload');\n\t};\n\tproto.getRangeByIndex = function(index, length) {\n\t\treturn {\n\t\t\tfrom: 0,\n\t\t\tto: length - 1\n\t\t};\n\t\t//\t\tvar from = Math.max(index - 1, 0);\n\t\t//\t\tvar to = Math.min(index + 1, length);\n\t\t//\t\tif (index === length - 1) {\n\t\t//\t\t\tfrom = Math.max(length - 3, 0);\n\t\t//\t\t\tto = length - 1;\n\t\t//\t\t}\n\t\t//\t\tif (index === 0) {\n\t\t//\t\t\tfrom = 0;\n\t\t//\t\t\tto = Math.min(2, length - 1);\n\t\t//\t\t}\n\t\t//\t\treturn {\n\t\t//\t\t\tfrom: from,\n\t\t//\t\t\tto: to\n\t\t//\t\t};\n\t};\n\n\tproto._getPosition = function(itemData) {\n\t\tvar sLeft = itemData.sLeft - window.pageXOffset;\n\t\tvar sTop = itemData.sTop - window.pageYOffset;\n\t\tvar left = (window.innerWidth - itemData.sWidth) / 2;\n\t\tvar top = (window.innerHeight - itemData.sHeight) / 2;\n\t\treturn {\n\t\t\tleft: sLeft,\n\t\t\ttop: sTop,\n\t\t\tx: sLeft - left,\n\t\t\ty: sTop - top\n\t\t};\n\t};\n\tproto.refresh = function(index, groupArray) {\n\t\tthis.currentGroup = groupArray;\n\t\t//重新生成slider\n\t\tvar length = groupArray.length;\n\t\tvar itemHtml = [];\n\t\tvar currentRange = this.getRangeByIndex(index, length);\n\t\tvar from = currentRange.from;\n\t\tvar to = currentRange.to + 1;\n\t\tvar currentIndex = index;\n\t\tvar className = '';\n\t\tvar itemStr = '';\n\t\tvar wWidth = window.innerWidth;\n\t\tvar wHeight = window.innerHeight;\n\t\tfor (var i = 0; from < to; from++, i++) {\n\t\t\tvar itemData = groupArray[from];\n\t\t\tvar style = '';\n\t\t\tif (itemData.sWidth) {\n\t\t\t\tstyle = '-webkit-transform:translate3d(0,0,0) scale(' + itemData.sScale + ');transform:translate3d(0,0,0) scale(' + itemData.sScale + ')';\n\t\t\t}\n\t\t\titemStr = itemTemplate.replace('{{src}}', itemData.src).replace('{{lazyload}}', itemData.lazyload).replace('{{style}}', style);\n\t\t\tif (from === index) {\n\t\t\t\tcurrentIndex = i;\n\t\t\t\tclassName = $.className('active');\n\t\t\t} else {\n\t\t\t\tclassName = '';\n\t\t\t}\n\t\t\titemHtml.push(itemStr.replace('{{className}}', className));\n\t\t}\n\t\tthis.scroller.innerHTML = itemHtml.join('');\n\t\tthis.element.style.display = 'block';\n\t\tthis.element.classList.add($.className('preview-in'));\n\t\tthis.lastIndex = currentIndex;\n\t\tthis.element.offsetHeight;\n\t\t$(this.element).slider().gotoItem(currentIndex, 0);\n\t\tthis.indicator && (this.indicator.innerText = (currentIndex + 1) + '/' + this.currentGroup.length);\n\t\tthis._loadItem(currentIndex, true);\n\t};\n\tproto.openByGroup = function(index, group) {\n\t\tindex = Math.min(Math.max(0, index), this.groups[group].length - 1);\n\t\tthis.refresh(index, this.groups[group]);\n\t};\n\tproto.open = function(index, group) {\n\t\tif (this.isShown()) {\n\t\t\treturn;\n\t\t}\n\t\tif (typeof index === \"number\") {\n\t\t\tgroup = group || defaultGroupName;\n\t\t\tthis.addImages(group, index); //刷新当前group\n\t\t\tthis.openByGroup(index, group);\n\t\t} else {\n\t\t\tgroup = index.getAttribute('data-preview-group');\n\t\t\tgroup = group || defaultGroupName;\n\t\t\tthis.addImages(group, index); //刷新当前group\n\t\t\tthis.openByGroup(this.groups[group].indexOf(index.__mui_img_data), group);\n\t\t}\n\t};\n\tproto.close = function(index, group) {\n\t\tif (!this.isShown()) {\n\t\t\treturn;\n\t\t}\n\t\tthis.element.classList.remove($.className('preview-in'));\n\t\tthis.element.classList.add($.className('preview-out'));\n\t\tvar itemEl = this.scroller.querySelector($.classSelector('.slider-item:nth-child(' + (this.lastIndex + 1) + ')'));\n\t\tvar imgEl = itemEl.querySelector('img');\n\t\tif (imgEl) {\n\t\t\timgEl.classList.add($.className('transitioning'));\n\t\t\tvar itemData = this.currentGroup[this.lastIndex];\n\t\t\tvar posi = this._getPosition(itemData);\n\t\t\tvar sLeft = posi.left;\n\t\t\tvar sTop = posi.top;\n\t\t\tif (sTop > window.innerHeight || sLeft > window.innerWidth || sTop < 0 || sLeft < 0) { //out viewport\n\t\t\t\timgEl.style.opacity = 0;\n\t\t\t\timgEl.style.webkitTransitionDuration = '0.5s';\n\t\t\t\timgEl.style.webkitTransform = 'scale(' + itemData.sScale + ')';\n\t\t\t} else {\n\t\t\t\tif (this.options.zoom) {\n\t\t\t\t\t$(imgEl.parentNode.parentNode).zoom().toggleZoom(0);\n\t\t\t\t}\n\t\t\t\timgEl.style.webkitTransitionDuration = '0.5s';\n\t\t\t\timgEl.style.webkitTransform = 'translate3d(' + posi.x + 'px,' + posi.y + 'px,0) scale(' + itemData.sScale + ')';\n\t\t\t}\n\t\t}\n\t\tvar zoomers = this.element.querySelectorAll($.classSelector('.zoom-wrapper'));\n\t\tfor (var i = 0, len = zoomers.length; i < len; i++) {\n\t\t\t$(zoomers[i]).zoom().destroy();\n\t\t}\n\t\t$(this.element).slider().destroy();\n//\t\tthis.empty();\n\t};\n\tproto.isShown = function() {\n\t\treturn this.element.classList.contains($.className('preview-in'));\n\t};\n\n\tvar previewImageApi = null;\n\t$.previewImage = function(options) {\n\t\tif (!previewImageApi) {\n\t\t\tpreviewImageApi = new PreviewImage(options);\n\t\t}\n\t\treturn previewImageApi;\n\t};\n\t$.getPreviewImage = function() {\n\t\treturn previewImageApi;\n\t}\n\n})(mui, window);"]}]}